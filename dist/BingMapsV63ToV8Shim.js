/*
Name: Bing Maps V6.3 to V8 Shim
Project: https://github.com/rbrundritt/BingMapsV63ToV8Shim
*/
var VEShapeCounter=1e3,VEShapeType=function(){function e(){}return e.Pushpin="Pushpin",e.Polyline="Polyline",e.Polygon="Polygon",e}(),VEMapMode;!function(e){e[e.Mode2D=0]="Mode2D",e[e.Mode3D=1]="Mode3D"}(VEMapMode||(VEMapMode={}));var VEMapStyle=function(){function e(){}return e.Road="r",e.Shaded="s",e.Aerial="a",e.Hybrid="h",e.Oblique="o",e.Birdseye="o",e.BirdseyeHybrid="b",e}(),VEOrientation=function(){function e(){}return e.North="North",e.South="South",e.East="East",e.West="West",e}(),VELatLong=function(){function e(e,t){this._location=new Microsoft.Maps.Location(e,t)}return Object.defineProperty(e.prototype,"Latitude",{get:function(){return this._location.latitude},set:function(e){this._location.latitude=e,this._updatedEvent&&this._updatedEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Longitude",{get:function(){return this._location.longitude},set:function(e){this._location.longitude=e,this._updatedEvent&&this._updatedEvent()},enumerable:!0,configurable:!0}),e._fromLocation=function(t){return new e(t.latitude,t.longitude)},e.prototype.SetAltitude=function(){},e}(),VELatLongRectangle=function(){function e(e,t){this._topLeft=e,this._bottomRight=t,this._updateBase()}return Object.defineProperty(e.prototype,"TopLeftLatLong",{get:function(){return this._topLeft},set:function(e){this._topLeft=e,this._topLeft._updatedEvent=this._updateBase,this._updateBase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BottomRightLatLong",{get:function(){return this._bottomRight},set:function(e){this._bottomRight=e,this._bottomRight._updatedEvent=this._updateBase,this._updateBase()},enumerable:!0,configurable:!0}),e.prototype._updateBase=function(){this._topLeft&&this._bottomRight&&(this._bounds=Microsoft.Maps.LocationRect.fromCorners(this._topLeft._location,this._bottomRight._location))},e._fromLocationRect=function(t){return t?new e(VELatLong._fromLocation(t.getNorthwest()),VELatLong._fromLocation(t.getSoutheast())):null},e}(),VEPixel=function(){function e(e,t){this.x=e,this.y=t}return e.prototype._getPoint=function(){return new Microsoft.Maps.Point(this.x,this.y)},e._fromPoint=function(t){return new e(t.x,t.y)},e}(),VEColor=function(){function e(e,t,o,i){this.A=i,this.R=e,this.G=t,this.B=o}return e.prototype._getV8Color=function(){return new Microsoft.Maps.Color(this.A,this.R,this.G,this.B)},e._fromV8Color=function(t){return new e(t.r,t.g,t.b,t.a)},e}(),VEShapeDragEventArgs=function(){function e(){}return e}(),VECustomIconSpecification=function(){function e(){}return e}(),VEShape=function(){function e(e,t){this._events=[],this._eventHandlers=[],this._infoboxOffset=new Microsoft.Maps.Point(0,0),this._shapeType=e,t&&this._initShape(t)}return Object.defineProperty(e.prototype,"Draggable",{get:function(){return this._shape instanceof Microsoft.Maps.Pushpin&&this._shape.getDraggable()},set:function(e){this._shape instanceof Microsoft.Maps.Pushpin&&this._shape.getDraggable()!=e&&this._shape.setOptions({draggable:e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ondrag",{get:function(){return this._events.drag},set:function(e){this._updateDragEvent("drag",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onstartdrag",{get:function(){return this._events.dragstart},set:function(e){this._updateDragEvent("dragstart",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onenddrag",{get:function(){return this._events.dragend},set:function(e){this._updateDragEvent("dragend",e)},enumerable:!0,configurable:!0}),e.prototype.GetCustomIcon=function(){if(this._shape instanceof Microsoft.Maps.Pushpin){var e=this._shape;return{Image:e.getIcon(),ImageOffset:VEPixel._fromPoint(e.getAnchor()),TextContent:e.getText(),TextOffset:VEPixel._fromPoint(e.getTextOffset())}}return null},e.prototype.SetCustomIcon=function(e){e instanceof VECustomIconSpecification&&this._shape instanceof Microsoft.Maps.Pushpin&&this._shape.setOptions({icon:e.Image,anchor:e.ImageOffset?e.ImageOffset._getPoint():null,text:e.TextContent,textOffset:e.ImageOffset?e.TextOffset._getPoint():null})},e.prototype.GetDescription=function(){return this._shape.metadata.description},e.prototype.SetDescription=function(e){this._shape.metadata.description=e},e.prototype.GetFillColor=function(){return this._shape instanceof Microsoft.Maps.Polygon?VEColor._fromV8Color(this._shape.getFillColor()):null},e.prototype.SetFillColor=function(e){this._shape instanceof Microsoft.Maps.Polygon&&this._shape.setOptions({fillColor:e._getV8Color()})},e.prototype.GetLineColor=function(){return this._shape instanceof Microsoft.Maps.Pushpin?null:VEColor._fromV8Color(this._shape.getStrokeColor())},e.prototype.SetLineColor=function(e){this._shape instanceof Microsoft.Maps.Pushpin||this._shape.setOptions({strokeColor:e._getV8Color()})},e.prototype.GetIconAnchor=function(){return this._shape instanceof Microsoft.Maps.Pushpin?VELatLong._fromLocation(this._shape.getLocation()):null},e.prototype.SetIconAnchor=function(e){this._shape instanceof Microsoft.Maps.Pushpin&&this._shape.setLocation(e._location)},e.prototype.GetId=function(){return this._shape.metadata.id},e.prototype.GetPoints=function(){if(this._shape instanceof Microsoft.Maps.Pushpin)return[VELatLong._fromLocation(this._shape.getLocation())];for(var e=this._shape.getLocations(),t=[],o=0,i=e.length;o<i;o++)t.push(VELatLong._fromLocation(e[o]));return t},e.prototype.SetPoints=function(e){if(this._shape instanceof Microsoft.Maps.Pushpin)e instanceof Array?this._shape.setLocation(e[0]._location):this._shape.setLocation(e._location);else if(e instanceof Array){for(var t=[],o=0;o<e.length;o++)t.push(e[o]._location);this._shape.setLocations(t)}},e.prototype.GetShapeLayer=function(){return this._layer},e.prototype.GetTitle=function(){return this._shape.metadata.title},e.prototype.SetTitle=function(e){this._shape.metadata.title=e},e.prototype.GetType=function(){return this._shapeType},e.prototype.Hide=function(){this._shape.setOptions({visible:!1})},e.prototype.Show=function(){this._shape.setOptions({visible:!0})},e._fromPrimitive=function(t){var o;return t instanceof Microsoft.Maps.Pushpin?o=new e(VEShapeType.Pushpin,null):t instanceof Microsoft.Maps.Polyline?o=new e(VEShapeType.Polyline,null):t instanceof Microsoft.Maps.Polygon&&(o=new e(VEShapeType.Polygon,null)),VEShapeCounter++,t.metadata.id="VEShape_"+VEShapeCounter,t.metadata.parent=o,o._shape=t,o},e.prototype._initShape=function(e){if(this._shape=null,null!=e){var t=[];if(e instanceof Array)for(var o=0;o<e.length;o++)t.push(e[o]._location);else t.push(e._location);switch(this._shapeType){case VEShapeType.Pushpin:this._shape=new Microsoft.Maps.Pushpin(t[0]);break;case VEShapeType.Polyline:e instanceof Array&&(this._shape=new Microsoft.Maps.Polyline(t));break;case VEShapeType.Polygon:e instanceof Array&&(this._shape=new Microsoft.Maps.Polygon(t))}this._shape&&(VEShapeCounter++,this._shape.metadata={id:"VEShape_"+VEShapeCounter,parent:this})}},e.prototype._updateDragEvent=function(e,t){var o=this;t?(this._events[e]=function(e){"dragstart"===e.eventName&&(o._map?o._map.HideInfoBox():o._layer&&o._layer._map.HideInfoBox()),t({Shape:o,LatLong:VELatLong._fromLocation(o._shape.getLocation())})},this._shape instanceof Microsoft.Maps.Pushpin&&(this._eventHandlers[e]&&Microsoft.Maps.Events.removeHandler(this._eventHandlers[e]),this._eventHandlers[e]=Microsoft.Maps.Events.addHandler(this._shape,e,this._events[e]))):(this._events[e]=null,this._eventHandlers[e]&&Microsoft.Maps.Events.removeHandler(this._eventHandlers[e]))},e.prototype.GetAltitude=function(){return 0},e.prototype.SetAltitude=function(){},e.prototype.GetAltitudeMode=function(){return null},e.prototype.SetAltitudeMode=function(){},e.prototype.GetLineToGround=function(){return!1},e.prototype.SetLineToGround=function(){},e.prototype.GetMaxZoomLevel=function(){return 19},e.prototype.SetMaxZoomLevel=function(e){},e.prototype.GetMinZoomLevel=function(){return 1},e.prototype.SetMinZoomLevel=function(e){},e.prototype.GetZIndex=function(){return 1},e.prototype.SetZIndex=function(e){},e}(),VEShapeLayer=function(){function e(){var e=this;this._layer=new Microsoft.Maps.Layer,this._layer.metadata={parent:this},Microsoft.Maps.Events.addHandler(this._layer,"mouseover",function(t){e._map&&e._map._shapeHovered(t)}),Microsoft.Maps.Events.addHandler(this._layer,"mouseout",function(t){e._map&&e._map._infobox.setOptions({visible:!1})})}return e.prototype.AddShape=function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)e[t]._layer=this,e[t]._map=this._map,this._layer.add(e[t]._shape);else e._layer=this,e._map=this._map,this._layer.add(e._shape)},e.prototype.DeleteAllShapes=function(){this._layer.clear()},e.prototype.DeleteShape=function(e){this._layer.remove(e._shape)},e.prototype.GetBoundingRectangle=function(){return VELatLongRectangle._fromLocationRect(Microsoft.Maps.LocationRect.fromShapes(this._layer.getPrimitives()))},e.prototype.GetDescription=function(){return this._layer.metadata.description},e.prototype.SetDescription=function(e){this._layer.metadata.description=e},e.prototype.GetTitle=function(){return this._layer.metadata.description},e.prototype.SetTitle=function(e){this._layer.metadata.description=e},e.prototype.GetShapeById=function(e){for(var t=this._layer.getPrimitives(),o=0,i=t.length;o<i;o++)if(t[o].metadata.id===e)return t[o].metadata.parent;return null},e.prototype.GetShapeByIndex=function(e){return this._layer.getPrimitives()[e].metadata.parent},e.prototype.GetShapeCount=function(){return this._layer.getPrimitives().length},e.prototype.IsIvisble=function(){return this._layer.getVisible()},e.prototype.Hide=function(){this._layer.setVisible(!1)},e.prototype.Show=function(){this._layer.setVisible(!0)},e.prototype.GetClusteredShapes=function(){},e.prototype.SetClusteringConfiguration=function(){},e.prototype._updateMapReference=function(){for(var e=this._layer.getPrimitives(),t=0,o=e.length;t<o;t++)e[t].metadata.parent._map=this._map},e}(),VETileSourceSpecification=function(){function e(e,t,o,i,n,a,r,s,p){this._id=e;var c={uriConstructor:t,bounds:i?i._bounds:null,minZoom:n,maxZoom:a};this._opacity=void 0!==s?s:1,this._updateTileSource(c)}return Object.defineProperty(e.prototype,"Bounds",{get:function(){return VELatLongRectangle._fromLocationRect(this._tileLayer.getTileSource().getBounds())},set:function(e){var t=this._getTileSourceOptions();t.bounds=e._bounds,this._updateTileSource(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ID",{get:function(){return this._id},set:function(e){this._id=e,this._tileLayer.metadata.id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Opacity",{get:function(){return this._opacity},set:function(e){this._opacity=e,this._tileLayer.setOptions({opacity:e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxZoomLevel",{get:function(){return this._tileLayer.getTileSource().getMaxZoom()},set:function(e){var t=this._getTileSourceOptions();t.maxZoom=e,this._updateTileSource(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MinZoomLevel",{get:function(){return this._tileLayer.getTileSource().getMinZoom()},set:function(e){var t=this._getTileSourceOptions();t.minZoom=e,this._updateTileSource(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TileSource",{get:function(){return this._tileLayer.getTileSource().getUriConstructor()},set:function(e){var t=this._getTileSourceOptions();t.uriConstructor=e,this._updateTileSource(t)},enumerable:!0,configurable:!0}),e.prototype._updateTileSource=function(e){e.uriConstructor=e.uriConstructor.replace("%2","{subdomain}").replace("%4","{quadkey}");var t={opacity:this._opacity,mercator:new Microsoft.Maps.TileSource(e)},o={id:this._id};this._tileLayer&&(t.visible=this._tileLayer.getVisible(),this._map&&this._map.layers.remove(this._tileLayer)),this._tileLayer=new Microsoft.Maps.TileLayer(t),o.parent=this._tileLayer,this._tileLayer.metadata=o,this._map&&this._map.layers.insert(this._tileLayer)},e.prototype._getTileSourceOptions=function(){var e=this._tileLayer.getTileSource();return{bounds:e.getBounds(),maxZoom:e.getMaxZoom(),minZoom:e.getMinZoom(),uriConstructor:e.getUriConstructor().replace("{subdomain}","%2").replace("{quadkey}","%4")}},e}(),VEMapOptions=function(){function e(){}return e}(),VEMap=function(){function e(e){this._events={},this._eventHandlers={},this._eventNamesV7ToV8={onclick:"click",ondoubleclick:"dblclick",onmousemove:"mousemove",onmousedown:"mousedown",onmouseup:"mouseup",onmouseover:"mouseover",onmouseout:"mouseout",onmousewheel:"mousewheel",onchangemapstyle:"maptypechanged"},this._eventNamesV8ToV7={click:"onclick",dblclick:"ondoubleclick",mousemove:"onmousemove",mousedown:"onmousedown",mouseup:"onmouseup",mouseover:"onmouseover",mouseout:"onmouseout",mousewheel:"onmousewheel",maptypechanged:"onchangemapstyle"},this._commonEvents=["onchangeview","oncredentialserror","oncredentialsvalid","onendpan","onendzoom","onresize","onstartpan","onstartzoom","onkeypress","onkeydown","onkeyup"],this._navteqNA="https://spatial.virtualearth.net/REST/v1/data/f22876ec257b474b82fe2ffcb8393150/NavteqNA/NavteqPOIs",this._navteqEU="https://spatial.virtualearth.net/REST/v1/data/c2ae584bbccc4916a0acf75d1e6947b4/NavteqEU/NavteqPOIs",this._poiTypes={2084:"Winery",3578:"ATM",4013:"Train Station",4100:"Commuter Rail Station",4170:"Bus Station",4444:"Named Place",4482:"Ferry Terminal",4493:"Marina",4580:"Public Sports Airport",4581:"Airport",5000:"Business Facility",5400:"Grocery Store",5511:"Auto Dealerships",5512:"Auto Dealership-Used Cars",5540:"Petrol/Gasoline Station",5571:"Motorcycle Dealership",5800:"Restaurant",5813:"Nightlife",5999:"Historical Monument",6000:"Bank",6512:"Shopping",7011:"Hotel",7012:"Ski Resort",7013:"Other Accommodation",7014:"Ski Lift",7389:"Tourist Information",7510:"Rental Car Agency",7520:"Parking Lot",7521:"Parking Garage/House",7522:"Park & Ride",7538:"Auto Service & Maintenance",7832:"Cinema",7897:"Rest Area",7929:"Performing Arts",7933:"Bowling Centre",7940:"Sports Complex",7947:"Park/Recreation Area",7985:"Casino",7990:"Convention/Exhibition Centre",7992:"Golf Course",7994:"Civic/Community Centre",7996:"Amusement Park",7997:"Sports Centre",7998:"Ice Skating Rink",7999:"Tourist Attraction",8060:"Hospital",8200:"Higher Education",8211:"School",8231:"Library",8410:"Museum",8699:"Automobile Club",9121:"City Hall",9211:"Court House",9221:"Police Station",9517:"Campground",9522:"Truck Stop/Plaza",9525:"Government Office",9530:"Post Office",9535:"Convenience Store",9537:"Clothing Store",9545:"Department Store",9560:"Home Specialty Store",9565:"Pharmacy",9567:"Specialty Store",9568:"Sporting Goods Store",9583:"Medical Service",9590:"Residential Area/Building",9591:"Cemetery",9592:"Highway Exit",9593:"Transportation Service",9710:"Weigh Station",9714:"Cargo Centre",9715:"Military Base",9718:"Animal Park",9719:"Truck Dealership",9986:"Home Improvement & Hardware Store",9987:"Consumer Electronics Store",9988:"Office Supply & Services Store",9991:"Industrial Zone",9992:"Place of Worship",9993:"Embassy",9994:"County Council",9995:"Bookstore",9996:"Coffee Shop",9998:"Hamlet",9999:"Border Crossing"},this._phoneRx=/([0-9]{3}-)([0-9]{3})([0-9]{4})/gi,this._waypointIcon='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="52" height="49.4" viewBox="0 0 37 35" xml:space="preserve"><circle cx="32" cy="30" r="4" style="stroke-width:2;stroke:#ffffff;fill:#000000;"/><polygon style="fill:rgba(0,0,0,0.5)" points="18,1 32,30 18,18 18,1"/><rect x="2" y="2" width="15" height="15" style="stroke-width:2;stroke:#000000;fill:{color}"/><text x="9" y="13" style="font-size:11px;font-family:arial;fill:#ffffff;" text-anchor="middle">{text}</text></svg>',this._connectingWords=[" in "," near "," around "," by "],this._rootElm=document.getElementById(e),Microsoft.Maps.loadModule(["Microsoft.Maps.SpatialMath"])}return e.prototype.AddShape=function(e){if(this._map)if(e instanceof Array)for(var t=0;t<e.length;t++)this._map.entities.push(e[t]._shape),e[t]._map=this;else this._map.entities.push(e._shape),e._map=this},e.prototype.AddShapeLayer=function(e){this._map&&(e._map=this,e._updateMapReference(),this._map.layers.insert(e._layer))},e.prototype.AddTileLayer=function(e,t){this._map&&("boolean"==typeof t&&e._tileLayer.setOptions({visible:t}),this._map.layers.insert(e._tileLayer),e._map=this._map)},e.prototype.AttachEvent=function(e,t){var o=this._eventNamesV7ToV8[e];if(o)this._updateEvent(o,t),"onclick"==e&&this._updateEvent("rightclick",t);else if(this._commonEvents.indexOf(e)>-1)switch(e){case"onchangeview":case"resize":case"onendpan":case"onendzoom":case"onresize":case"onstartpan":case"onstartzoom":case"onkeypress":case"onkeydown":case"onkeyup":this._events[e]=t}},e.prototype.DetachEvent=function(e){var t=this._eventNamesV7ToV8[e];this._commonEvents[e];if(t)this._updateEvent(t),"onclick"==e&&this._updateEvent("rightclick");else switch(e){case"onchangeview":case"resize":case"onendpan":case"onendzoom":case"onresize":case"onstartpan":case"onstartzoom":this._events[e]=null}},e.prototype.HideInfoBox=function(){this._infobox.setOptions({visible:!1})},e.prototype.ClearTraffic=function(){this._trafficManager&&this._trafficManager.hide()},e.prototype.DeleteAllShapeLayers=function(){for(var e=this._map.layers.length;e>=0;e--)this._map.layers[e]instanceof Microsoft.Maps.Layer&&(this._map.layers[e].metadata.parent._map=null,this._map.layers.remove(this._map.layers[e]));this._map.entities.clear()},e.prototype.DeleteAllShapes=function(){for(var e=this._map.layers.length;e>=0;e--)this._map.layers[e]instanceof Microsoft.Maps.Layer&&this._map.layers[e].clear();this._map.entities.clear()},e.prototype.DeleteShape=function(e){e._layer?e._layer._layer.remove(e._shape):this._map.entities.indexOf(e._shape)>-1&&this._map.entities.remove(e._shape)},e.prototype.DeleteShapeLayer=function(e){e._map=null,this._map.layers.remove(e._layer)},e.prototype.DeleteTileLayer=function(e){this._map.layers.remove(e._tileLayer)},e.prototype.Dispose=function(){this._map.dispose()},e.prototype.SetCredentials=function(e){this._key=e},e.prototype.SetClientToken=function(e){this._key=e},e.prototype.GetCenter=function(){return VELatLong._fromLocation(this._map.getCenter())},e.prototype.SetCenter=function(e){this._map.setView({center:e._location})},e.prototype.GetHeading=function(){return this._map.getHeading()},e.prototype.GetMapMode=function(){return VEMapMode.Mode2D},e.prototype.SetMapMode=function(e){},e.prototype.GetMapStyle=function(){switch(this._map.getMapTypeId()){case Microsoft.Maps.MapTypeId.aerial:return VEMapStyle.Hybrid;case Microsoft.Maps.MapTypeId.birdseye:return VEMapStyle.BirdseyeHybrid}return VEMapStyle.Road},e.prototype.SetMapStyle=function(e){var t={labelOverlay:Microsoft.Maps.LabelOverlay.visible};switch(e){case VEMapStyle.Aerial:t.mapTypeId=Microsoft.Maps.MapTypeId.aerial,t.labelOverlay=Microsoft.Maps.LabelOverlay.hidden;break;case VEMapStyle.Oblique:case VEMapStyle.Birdseye:t.mapTypeId=Microsoft.Maps.MapTypeId.birdseye,t.labelOverlay=Microsoft.Maps.LabelOverlay.hidden,this._map.getZoom()<18&&(t.zoom=18);break;case VEMapStyle.BirdseyeHybrid:t.mapTypeId=Microsoft.Maps.MapTypeId.birdseye,this._map.getZoom()<18&&(t.zoom=18);break;case VEMapStyle.Hybrid:t.mapTypeId=Microsoft.Maps.MapTypeId.aerial;break;case VEMapStyle.Road:case VEMapStyle.Shaded:t.mapTypeId=Microsoft.Maps.MapTypeId.aerial}this._map.setView(t)},e.prototype.GetMapView=function(){return VELatLongRectangle._fromLocationRect(this._map.getBounds())},e.prototype.SetMapView=function(e){this._map.setView({bounds:e._bounds})},e.prototype.GetShapeById=function(e){for(var t,o=0;o<this._map.layers.length;o++)if(this._map.layers[o]instanceof Microsoft.Maps.Layer&&(t=this._map.layers[o].metadata.parent.GetShapeById(e)))return t;for(o=0;o<this._map.entities.getLength();o++)if((t=this._map.entities.get(o))._shape.metadata.id===e)return t},e.prototype.GetShapeLayerByIndex=function(e){for(var t=0,o=0;o<this._map.layers.length;o++)if(this._map.layers[o]instanceof Microsoft.Maps.Layer){if(t===e)return this._map.layers[o];t++}},e.prototype.GetShapeLayerCount=function(e){for(var t=0,o=0;o<this._map.layers.length;o++)this._map.layers[o]instanceof Microsoft.Maps.Layer&&t++;return t},e.prototype.GetTileLayerById=function(e){for(var t=0;t<this._map.layers.length;t++)if(this._map.layers[t]instanceof VETileSourceSpecification&&this._map.layers[t].metadata.id===e)return this._map.layers[t]},e.prototype.GetTileLayerByIndex=function(e){for(var t=0,o=0;o<this._map.layers.length;o++)if(this._map.layers[o]instanceof VETileSourceSpecification){if(t===e)return this._map.layers[o];t++}},e.prototype.GetTileLayerCount=function(e){for(var t=0,o=0;o<this._map.layers.length;o++)this._map.layers[o]instanceof VETileSourceSpecification&&t++;return t},e.prototype.GetVersion=function(){return"V8"},e.prototype.GetZoomLevel=function(){return this._map.getZoom()},e.prototype.SetZoomLevel=function(e){this._map.setView({zoom:e})},e.prototype.HideAllShapeLayers=function(){for(var e=this._map.layers.length;e>=0;e--)this._map.layers[e]instanceof Microsoft.Maps.Layer&&this._map.layers[e].setVisible(!1)},e.prototype.ShowAllShapeLayers=function(){for(var e=this._map.layers.length;e>=0;e--)this._map.layers[e]instanceof Microsoft.Maps.Layer&&this._map.layers[e].setVisible(!0)},e.prototype.HideBaseTileLayer=function(){this._map.setMapType(Microsoft.Maps.MapTypeId.mercator)},e.prototype.ShowBaseTileLayer=function(){this._map.setMapType(Microsoft.Maps.MapTypeId.road)},e.prototype.HideTileLayer=function(e){this.GetTileLayerById(e)._tileLayer.setVisible(!1)},e.prototype.ShowTileLayer=function(e){this.GetTileLayerById(e)._tileLayer.setVisible(!0)},e.prototype.HideTrafficLegend=function(){this._trafficManager&&this._trafficManager.hideLegend()},e.prototype.IncludePointInView=function(e){var t=this._map.getBounds();Microsoft.Maps.LocationRect.fromLocations([t.getNorthwest(),t.getSoutheast(),e._location]);this._map.setView({bounds:t})},e.prototype.LatLongToPixel=function(e,t,o){var i,n=Math.pow(2,t-this._map.getZoom()),a=this._map.tryLocationToPixel(new Microsoft.Maps.Location(-180,85.5));if(e instanceof Array){i=[];for(var r=0;r<e.length;r++){var s=Microsoft.Maps.SpatialMath.Tiles.locationToGlobalPixel(e[r]._location,t);s.x+=a.x*n,s.y+=a.y*n,i.push(s)}}else e instanceof VELatLong&&((i=Microsoft.Maps.SpatialMath.Tiles.locationToGlobalPixel(e._location,t)).x+=a.x*n,i.y+=a.y*n);if(!o)return i;o(i)},e.prototype.PixelToLatLong=function(e){return VELatLong._fromLocation(this._map.tryPixelToLocation(e._getPoint()))},e.prototype.LoadMap=function(e,t,o,i,n,a,r,s){var p=this,c={center:e?e._location:null,zoom:t,credentials:this._key,allowInfoboxOverflow:!0};if(o)switch(o){case VEMapStyle.Aerial:c.mapTypeId=Microsoft.Maps.MapTypeId.aerial,c.labelOverlay=Microsoft.Maps.LabelOverlay.hidden;break;case VEMapStyle.Oblique:case VEMapStyle.Birdseye:c.mapTypeId=Microsoft.Maps.MapTypeId.aerial,c.labelOverlay=Microsoft.Maps.LabelOverlay.hidden;break;case VEMapStyle.BirdseyeHybrid:case VEMapStyle.Hybrid:c.mapTypeId=Microsoft.Maps.MapTypeId.aerial;break;case VEMapStyle.Road:case VEMapStyle.Shaded:c.mapTypeId=Microsoft.Maps.MapTypeId.aerial}if(s)switch(s.BirdseyeOrientation){case VEOrientation.North:c.heading=0;break;case VEOrientation.South:c.heading=180;break;case VEOrientation.East:c.heading=90;break;case VEOrientation.West:c.heading=270}this._map=new Microsoft.Maps.Map(this._rootElm,c),this._infobox=new Microsoft.Maps.Infobox(this._map.getCenter(),{showCloseButton:!1,visible:!1,maxHeight:200,maxWidth:320}),this._infobox.setMap(this._map);var u=this._map.getCenter(),l=this._map.getZoom(),h=this;Microsoft.Maps.Events.addHandler(this._map,"viewchange",function(e){p._events.onchangeview&&p._events.onchangeview(h._fillEventArg(e,"onchangeview",h._map))}),Microsoft.Maps.Events.addHandler(this._map,"viewchangestart",function(e){h._events.onstartzoom&&h._events.onstartzoom(h._fillEventArg(e,"onstartzoom",h._map)),h._events.onstartpan&&h._events.onstartpan(h._fillEventArg(e,"onstartpan",h._map))}),Microsoft.Maps.Events.addHandler(this._map,"viewchangeend",function(e){h._events.onendzoom&&h._events.onendzoom(h._fillEventArg(e,"onendzoom",h._map)),h._events.onendpan&&h._events.onendpan(h._fillEventArg(e,"onendpan",h._map)),u=h._map.getCenter(),l=h._map.getZoom()}),Microsoft.Maps.Events.addHandler(this._map.entities,"mouseover",function(e){p._shapeHovered(e)}),Microsoft.Maps.Events.addHandler(this._map.entities,"mouseout",function(e){p._infobox.setOptions({visible:!1})}),this._rootElm.addEventListener("keydown",function(e){h._events.onkeydown&&(e.eventName="onkeydown",e.mapStyle=h.GetMapStyle(),e.zoomLevel=h.GetZoomLevel(),h._events.onkeydown(e))},!1),this._rootElm.addEventListener("keypress",function(e){h._events.onkeypress&&(e.eventName="onkeypress",e.mapStyle=h.GetMapStyle(),e.zoomLevel=h.GetZoomLevel(),h._events.onkeypress(e))},!1),this._rootElm.addEventListener("keyup",function(e){h._events.onkeyup&&(e.eventName="onkeyup",e.mapStyle=h.GetMapStyle(),e.zoomLevel=h.GetZoomLevel(),h._events.onkeyup(e))},!1),this.onLoadMap&&this.onLoadMap()},e.prototype.LoadTraffic=function(){if(this._trafficManager)this._trafficManager.show();else{var e=this;Microsoft.Maps.loadModule("Microsoft.Maps.Traffic",function(){e._trafficManager=new Microsoft.Maps.Traffic.TrafficManager(e._map),e._trafficManager.show()})}},e.prototype.Resize=function(e,t){this._rootElm.style.width=e+"px",this._rootElm.style.height=t+"px",this._events.resize&&this._events.resize()},e.prototype.SetBirdseyeOrientation=function(e){var t={};switch(e){case VEOrientation.North:t.heading=0;break;case VEOrientation.South:t.heading=180;break;case VEOrientation.East:t.heading=90;break;case VEOrientation.West:t.heading=270}this._map.setView(t)},e.prototype.SetCenterAndZoom=function(e,t){this._map.setView({center:e._location,zoom:t})},e.prototype.ShowInfoBox=function(e,t,o){var i=null;i=t?t instanceof VEPixel?this._map.tryPixelToLocation(t._getPoint()):t._location:e._shape instanceof Microsoft.Maps.Pushpin?e._shape.getLocation():Microsoft.Maps.SpatialMath.Geometry.centroid(e._shape);var n={title:e._shape.metadata.title||"",description:e._shape.metadata.description||"",location:i,offset:o?o._getPoint():e._infoboxOffset,visible:!0};this._infobox.setOptions(n)},e.prototype.ShowTrafficLegend=function(){this._trafficManager&&this._trafficManager.showLegend()},e.prototype.ZoomIn=function(){this._map.setView({zoom:this._map.getZoom()+1})},e.prototype.ZoomOut=function(){this._map.setView({zoom:this._map.getZoom()-1})},e.prototype.GetLeft=function(){return this._rootElm.clientLeft},e.prototype.GetTop=function(){return this._rootElm.clientTop},e.prototype.Find=function(e,t,o,i,n,a,r,s,p,c,u){var l=this;void 0===n&&(n=0),void 0===a&&(a=10),void 0===r&&(r=!0),void 0===c&&(c=!0),this._searchManager&&Microsoft.Maps.SpatialDataService?t?this._searchManager.geocode({where:t,callback:function(t){t&&t.results&&t.results.length>0?l._performPoiSearch(e,t.results[0].location,i,n,a,r,s,c,l._convertPlaceResults(t.results),u):u&&u(null)}}):e?this._searchManager.reverseGeocode({location:this._map.getCenter(),callback:function(t){l._performPoiSearch(e,l._map.getCenter(),i,n,a,r,s,c,l._convertPlaceResults([t]),u)}}):u&&u(null):Microsoft.Maps.loadModule(["Microsoft.Maps.Search","Microsoft.Maps.SpatialDataService"],function(){l._searchManager=new Microsoft.Maps.Search.SearchManager(l._map)})},e.prototype._performPoiSearch=function(e,t,o,i,n,a,r,s,p,c){var u=this;void 0===a&&(a=!0),e=e.toLowerCase();var l=this;Microsoft.Maps.SpatialDataService.QueryAPIManager.search({skip:i,top:250,queryUrl:t.longitude<-6?this._navteqNA:this._navteqEU,inlineCount:!0,spatialFilter:{spatialFilterType:"nearby",location:t,radius:25},filter:this._createPoiFilter(e)},this._map,function(t,r){if(t&&t.length>0){for(var h=[],f=[],d=[],y=0;y<t.length;y++){if(e){if(u._fuzzyPoiMatch(e,t[y].metadata)){m=l._convertFindResult(t[y]);h.push(m),f.push(m.Shape),d.push(m.Shape._shape.getLocation())}}else{var m=l._convertFindResult(t[y]);h.push(m),f.push(m.Shape),d.push(m.Shape._shape.getLocation())}if(h.length>=n)break}a&&f.length>0&&(o?o.AddShape(f):l.AddShape(f)),s&&l._map.setView({bounds:Microsoft.Maps.LocationRect.fromLocations(d),padding:30}),c&&c(o,h,p,i+n<r,null)}else c&&c(null)})},e.prototype._fuzzyPoiMatch=function(e,t){return t.Name&&t.Name.toLowerCase().indexOf(e)>-1||t.DisplayName&&t.DisplayName.toLowerCase().indexOf(e)>-1||t.EntityTypeID&&this._poiTypes[t.EntityTypeID]&&this._poiTypes[t.EntityTypeID].toLowerCase().indexOf(e)>-1},e.prototype._createPoiFilter=function(e){if(e){for(var t=Object.keys(this._poiTypes),o=[],i=0;i<t.length;i++)this._poiTypes[t[i]].toLowerCase().indexOf(e)>-1&&o.push(t[i]);if(o.length>0)return new Microsoft.Maps.SpatialDataService.Filter("EntityTypeID",Microsoft.Maps.SpatialDataService.FilterCompareOperator.isIn,o)}return null},e.prototype._convertFindResult=function(e){var t=VEShape._fromPrimitive(e),o=t._shape.metadata,i=o.Phone||"";this._phoneRx.test(o.Phone)&&(i=o.Phone.replace(this._phoneRx,"$1$2-$3"));var n=[o.AddressLine,"<br/>",o.Locality,", ",o.AdminDistrict,"<br/>",o.PostalCode];return""!==i&&n.push('<br/><br/><div style="min-width:200px;">Phone: ',i,"</div>"),t._shape.metadata.title=e.metadata.DisplayName,t._shape.metadata.description=n.join(""),{Shape:t,Name:o.DisplayName,Description:n.join(""),LatLong:VELatLong._fromLocation(e.getLocation()),IsSponsored:!1,FindType:VEFindType.Businesses,Phone:o.Phone}},e.prototype.FindLocations=function(e,t){var o=this;this._searchManager?t&&this._searchManager.reverseGeocode({location:e._location,callback:function(e){t(o._convertPlaceResults([e]))}}):Microsoft.Maps.loadModule("Microsoft.Maps.Search",function(){o._searchManager=new Microsoft.Maps.Search.SearchManager(o._map)})},e.prototype.Geocode=function(e,t,o){var i=this;this._searchManager?t&&this._searchManager.geocode({where:e,callback:function(e){var n=i._convertPlaceResults(e.results),a=!0;o&&"boolean"==typeof o.SetBestMapView&&(a=o.SetBestMapView),a&&n&&n.length>0&&i._map.setView({bounds:e.results[0].bestView}),t(null,null,n,!1,null)}}):Microsoft.Maps.loadModule("Microsoft.Maps.Search",function(){i._searchManager=new Microsoft.Maps.Search.SearchManager(i._map)})},e.prototype.GetDirections=function(e,t){var o=this;if(t=t||new VERouteOptions,!e||e.length>25)t.RouteCallback(null);else if(this._directionsManager){this._directionsManager.clearAll();for(var i=0;i<e.length;i++)e[i]instanceof VELatLong?this._directionsManager.addWaypoint(new Microsoft.Maps.Directions.Waypoint({location:e[i]._location})):this._directionsManager.addWaypoint(new Microsoft.Maps.Directions.Waypoint({address:e[i]}));var n;n=t.RouteOptimize==VERouteOptimize.MinimizeDistance?Microsoft.Maps.Directions.RouteOptimization.shortestDistance:t.UseTraffic?Microsoft.Maps.Directions.RouteOptimization.timeWithTraffic:Microsoft.Maps.Directions.RouteOptimization.shortestTime,this._directionsManager.setRequestOptions({distanceUnit:t.DistanceUnit==VERouteDistanceUnit.Mile?Microsoft.Maps.Directions.DistanceUnit.miles:Microsoft.Maps.Directions.DistanceUnit.km,routeMode:t.RouteMode==VERouteMode.Driving?Microsoft.Maps.Directions.RouteMode.driving:Microsoft.Maps.Directions.RouteMode.walking,routeOptimization:n,routeDraggable:!1,maxRoutes:1});var a={strokeColor:t.RouteColor._getV8Color(),strokeThickness:t.RouteWeight,visible:t.DrawRoute};this._directionsManager.setRenderOptions({autoUpdateMapView:t.SetBestMapView,drivingPolylineOptions:a,walkingPolylineOptions:a,firstWaypointPushpinOptions:{visible:!1},lastWaypointPushpinOptions:{visible:!1},waypointPushpinOptions:{visible:!1}}),this._directionsManager.calculateDirections()}else Microsoft.Maps.loadModule("Microsoft.Maps.Directions",function(){o._directionsManager=new Microsoft.Maps.Directions.DirectionsManager(o._map),Microsoft.Maps.Events.addHandler(o._directionsManager,"directionsUpdated",function(e){if(t.RouteCallback&&e.route&&e.route.length>0){for(var i=e.route[0],n=[],a=0,r=0,s=[],p=[],c=0;c<i.routeLegs.length;c++){var u=o._convertRouteLeg(i.routeLegs[c],a,t.UseTraffic);if(a=u.Itinerary._idx,n.push(u),t.DrawRoute)for(var l=0;l<u.Itinerary.Items.length;l++)0==l?(u.Itinerary.Items[l].Shape._infoboxOffset=new Microsoft.Maps.Point(-30,25),0==c?(u.Itinerary.Items[l].Shape._shape.setOptions({icon:o._waypointIcon,anchor:new Microsoft.Maps.Point(42,39),color:"#008f09",text:"A"}),s.push(u.Itinerary.Items[l].Shape._shape),r++):(u.Itinerary.Items[l].Shape._shape.setOptions({icon:o._waypointIcon,anchor:new Microsoft.Maps.Point(42,39),color:"#737373",text:"ABCDEFGHIJKLMNOPQRSTYVWXYZ"[r]}),s.push(u.Itinerary.Items[l].Shape._shape),r++)):c==i.routeLegs.length-1&&l==u.Itinerary.Items.length-1?(u.Itinerary.Items[l].Shape._infoboxOffset=new Microsoft.Maps.Point(-30,25),u.Itinerary.Items[l].Shape._shape.setOptions({icon:o._waypointIcon,anchor:new Microsoft.Maps.Point(42,39),color:"#d60000",text:"ABCDEFGHIJKLMNOPQRSTYVWXYZ"[r]}),s.push(u.Itinerary.Items[l].Shape._shape),r++):p.push(u.Itinerary.Items[l].Shape._shape)}s.reverse(),o._map.entities.push(s),o._map.entities.push(p);for(var h=[],c=0;c<i.routePath.length;c++)h.push(VELatLong._fromLocation(i.routePath[c]));var f={Distance:e.routeSummary[0].distance,Time:t.UseTraffic?e.routeSummary[0].timeWithTraffic:e.routeSummary[0].time,RouteLegs:n,ShapePoints:h};t.RouteCallback(f)}}),o.GetDirections(e,t)})},e.prototype._convertRouteLeg=function(e,t,o){return{Distance:e.summary.distance,Time:o?e.summary.timeWithTraffic:e.summary.time,Itinerary:this._convertItinerary(e,t,o)}},e.prototype._convertItinerary=function(e,t,o){for(var i=[],n=0;n<e.itineraryItems.length;n++)t++,i.push(this._convertItineraryItem(e.itineraryItems[n],t));return{Items:i,_idx:t}},e.prototype._convertItineraryItem=function(e,t){var o=[],i=[];if(e.preIntersectionHints)for(n=0;n<e.preIntersectionHints.length;n++)o.push({Text:e.preIntersectionHints[n],Type:VERouteHintType.PreviousIntersection});if(e.postIntersectionHints)for(n=0;n<e.postIntersectionHints.length;n++)o.push({Text:e.postIntersectionHints[n],Type:VERouteHintType.NextIntersection});if(e.warnings)for(var n=0;n<e.warnings.length;n++){var a;switch(e.warnings[n].severity){case"Minor":a=VERouteWarningSeverity.Minor;break;case"Low Impact":case"LowImpact":a=VERouteWarningSeverity.LowImpact;break;case"Moderate":a=VERouteWarningSeverity.Moderate;break;case"Serious":a=VERouteWarningSeverity.Serious;break;case"None":a=VERouteWarningSeverity.None;break;default:e.warnings[n].severity}i.push({Text:e.warnings[n].text,Severity:a})}var r=new VEShape(VEShapeType.Pushpin,VELatLong._fromLocation(e.coordinate));return r._shape.metadata.isRoute=!0,r._shape.setOptions({icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="17" viewBox="0 0 36 34" xml:space="preserve"><circle cx="16" cy="16" r="14" style="fill:{color}"/><text x="16" y="21" style="font-size:16px;font-family:arial;fill:#ffffff;" text-anchor="middle">{text}</text></svg>',anchor:new Microsoft.Maps.Point(9,9),color:"#d60000",text:t+""}),r.SetDescription(e.formattedText),{Distance:parseFloat(e.distance),Time:e.durationInSeconds,LatLong:VELatLong._fromLocation(e.coordinate),Text:e.formattedText,Shape:r,Hints:o,Warnings:i}},e.prototype.DeleteRoute=function(){if(this._directionsManager){this._directionsManager.clearAll();for(var e,t=[],o=0;o<this._map.entities.getLength();o++)(e=this._map.entities.get(o)).metadata&&e.metadata.isRoute&&t.push(o);for(o=t.length-1;o>=0;o--)this._map.entities.removeAt(t[o])}},e.prototype.Search=function(e,t,o){if(e&&t){o=o||new VESearchOptions;var i,n=Object.keys(this._poiTypes);0!==(e=e.toLowerCase()).indexOf("find ")&&0!==e.indexOf("get ")||(e=e.replace("find ","").replace("get ",""));for(a=0;a<n.length;a++)if(this._poiTypes[n[a]].toLowerCase().indexOf(e)>-1){i=!0;break}if(i)return void this.Find(e,null,null,o.ShapeLayer,o.StartIndex,o.NumberOfResults,o.ShowResults,o.CreateResults,null,o.SetBestMapView,t);for(var a=0;a<this._connectingWords.length;a++)if(e.indexOf(this._connectingWords[a])>0){var r=e.split(this._connectingWords[a]);if(r.length>=2)return void this.Find(r[0],r[1],null,null,0,20,!0,!0,null,!0,t);if(1==r.length)return void this.Find(r[0],null,null,null,0,20,!0,!0,null,!0,t)}var s=new VEGeocodeOptions;s.SetBestMapView=o.SetBestMapView,this.Geocode(e,t,s)}},e.prototype.ImportShapeLayerData=function(e,t,o){var i=this;void 0===o&&(o=!0),e&&e.LayerSource&&Microsoft.Maps.loadModule("Microsoft.Maps.GeoXml",function(){e.Layer||(e.Layer=new VEShapeLayer),Microsoft.Maps.GeoXml.readFromUrl(e.LayerSource,null,function(n){if(n){for(var a=[],r=0;r<n.shapes.length;r++)a.push(VEShape._fromPrimitive(n.shapes[r]));for(r=0;r<n.layers.length;r++)if(n.layers[r]instanceof Microsoft.Maps.Layer)for(var s=n.layers[r].getPrimitives(),p=0;p<s.length;p++)a.push(VEShape._fromPrimitive(s[p]));e.Layer.AddShape(a),e.Layer._map||i.AddShapeLayer(e.Layer),o&&i._map.setView({bounds:n.summary.bounds,padding:30}),t&&t(e.Layer)}})})},e.prototype._convertPlaceResults=function(e){for(var t=[],o=0;o<e.length;o++){for(var i=VELocationPrecision.Interpolated,n=[],a=0;a<e[o].locations.length;a++)n.push({LatLong:VELatLong._fromLocation(e[o].locations[a]),Precision:this._convertLocationPrecision(e[o].locations[a].precision)}),n[a].Precision==VELocationPrecision.Rooftop&&(i=VELocationPrecision.Rooftop);switch(e[o].matchConfidence){case Microsoft.Maps.Search.MatchConfidence.high:r=VEMatchConfidence.High;break;case Microsoft.Maps.Search.MatchConfidence.low:r=VEMatchConfidence.Low;break;case Microsoft.Maps.Search.MatchConfidence.medium:r=VEMatchConfidence.Medium}var r;switch(e[o].matchCode){case Microsoft.Maps.Search.MatchCode.ambiguous:r=VEMatchCode.Ambiguous;break;case Microsoft.Maps.Search.MatchCode.good:r=VEMatchCode.Good;break;case Microsoft.Maps.Search.MatchCode.modified:r=VEMatchCode.Modified;break;case Microsoft.Maps.Search.MatchCode.none:r=VEMatchCode.None;break;case Microsoft.Maps.Search.MatchCode.upHierarchy:r=VEMatchCode.UpHierarchy}var s={LatLong:VELatLong._fromLocation(e[o].location),LatLongRect:VELatLongRectangle._fromLocationRect(e[o].bestView),Locations:n,Name:e[o].name,Precision:i,MathCode:r,MatchConfidence:void 0};t.push(s)}return 0==t.length&&(t=null),t},e.prototype._convertLocationPrecision=function(e){return"Rooftop"===e||"Parcel"===e?VELocationPrecision.Rooftop:VELocationPrecision.Interpolated},e.prototype._updateEvent=function(e,t){var o=this;if(t){var i=this._eventNamesV8ToV7[e];this._events[e]=function(n){var a=t(o._fillEventArg(n,i,n.target));"onmouseover"===e&&(o._disableInfoboxHover=!a)},this._eventHandlers[e]&&Microsoft.Maps.Events.removeHandler(this._eventHandlers[e]),this._eventHandlers[e]=Microsoft.Maps.Events.addHandler(this._map,e,this._events[e])}else this._events[e]=null,this._eventHandlers[e]&&Microsoft.Maps.Events.removeHandler(this._eventHandlers[e])},e.prototype._fillEventArg=function(e,t,o){var i=this,n=(e=e||{}).getX?e.getX():0,a=e.getY?e.getY():0,r={leftMouseButton:e.isPrimary,rightMouseButton:e.isSecondary,clientX:n,clientY:a,screenX:n+this.GetLeft(),screenY:a+this.GetTop(),mapX:n,mapY:a,latLong:e.location?VELatLong._fromLocation(e.location):null,mapStyle:this._map.getMapTypeId().toString(),zoomLevel:this._map.getZoom(),eventName:t};return"onclick"!==t&&"ondoubleclick"!==t||(r.elementID=this._lastMousedUpShapeId,r.leftMouseButton=this._lastMouseButtonLeft,r.rightMouseButton=this._lastMouseButtonRight),r.elementID||(e&&e.primitive&&e.primitive.metadata&&(r.elementID=e.primitive.metadata.id),o&&!r.elementID&&(o.metadata?r.elementID=o.metadata.id:o instanceof Microsoft.Maps.Map&&(r.elementID=this._rootElm.id))),"onmouseup"===t&&(this._lastMouseUpTimer&&clearTimeout(this._lastMouseUpTimer),this._lastMousedUpShapeId=r.elementID,this._lastMouseButtonLeft=e.isPrimary,this._lastMouseButtonRight=e.isSecondary,this._lastMouseUpTimer=setTimeout(function(){i._lastMousedUpShapeId=null,i._lastMouseButtonLeft=null,i._lastMouseButtonRight=null,i._lastMouseUpTimer=null},1)),"onmouseout"===t&&this._infobox.setOptions({visible:!1}),r},e.prototype._shapeHovered=function(e){this._disableInfoboxHover||!e.primitive.metadata.title&&!e.primitive.metadata.description||this._infobox.setOptions({location:e.primitive instanceof Microsoft.Maps.Pushpin?e.primitive.getLocation():Microsoft.Maps.SpatialMath.Geometry.centroid(e.primitive),title:e.primitive.metadata.title||"",description:e.primitive.metadata.description||"",offset:e.primitive.metadata.parent&&e.primitive.metadata.parent._infoboxOffset?e.primitive.metadata.parent._infoboxOffset:null,visible:!0})},e.prototype.AddControl=function(){},e.prototype.AddCustomLayer=function(){},e.prototype.ClearInfoBoxStyles=function(){},e.prototype.DeleteControl=function(){},e.prototype.EnableShapeDisplayThreshold=function(){},e.prototype.EndContinuousPan=function(){},e.prototype.GetAltitude=function(){return null},e.prototype.GetBirdseyeScene=function(){return null},e.prototype.GetImageryMetadata=function(){return null},e.prototype.GetPitch=function(){return 0},e.prototype.GetRoute=function(){return null},e.prototype.Hide3DNavigationControl=function(){},e.prototype.HideControl=function(){},e.prototype.HideDashboard=function(){},e.prototype.HideFindControl=function(){},e.prototype.HideMiniMap=function(){},e.prototype.HideScalebar=function(){},e.prototype.Import3DModel=function(){},e.prototype.IsBirdseyeAvailable=function(){return!1},e.prototype.PanToLatLong=function(){},e.prototype.RemoveCustomLayer=function(){},e.prototype.SetAltitude=function(){},e.prototype.SetBirdseyeScene=function(){},e.prototype.SetDashboardSize=function(){},e.prototype.SetDefaultInfoboxStyles=function(){},e.prototype.SetFailedShapeRequest=function(){},e.prototype.SetMouseWheelZoomToCenter=function(){},e.prototype.SetPitch=function(){},e.prototype.SetPrintOptions=function(){},e.prototype.SetScaleBarDistanceUnit=function(){},e.prototype.SetShapeAccuracy=function(){},e.prototype.SetShapesAccuracyRequestLimit=function(){},e.prototype.SetTileBuffer=function(){},e.prototype.SetTrafficLegendText=function(){},e.prototype.Show3DBirdseye=function(){},e.prototype.Show3DNavigationControl=function(){},e.prototype.ShowControl=function(){},e.prototype.ShowDashboard=function(){},e.prototype.ShowDisambiguationDialog=function(){},e.prototype.ShowFindControl=function(){},e.prototype.ShowMessage=function(){},e.prototype.ShowMiniMap=function(){},e.prototype.ShowScaleBar=function(){},e.prototype.StartContinuousPan=function(){},e.prototype.Pan=function(){},e}(),VEGeocodeOptions=function(){function e(){}return e}(),VEMatchCode;!function(e){e[e.None=0]="None",e[e.Good=1]="Good",e[e.Ambiguous=2]="Ambiguous",e[e.UpHierarchy=3]="UpHierarchy",e[e.Modified=4]="Modified"}(VEMatchCode||(VEMatchCode={}));var VEMatchConfidence;!function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(VEMatchConfidence||(VEMatchConfidence={}));var VELocationPrecision;!function(e){e[e.Interpolated=0]="Interpolated",e[e.Rooftop=1]="Rooftop"}(VELocationPrecision||(VELocationPrecision={}));var VEFindType;!function(e){e[e.Businesses=0]="Businesses"}(VEFindType||(VEFindType={}));var VERouteOptions=function(){function e(){this.DistanceUnit=VERouteDistanceUnit.Mile,this.DrawRoute=!0,this.RouteColor=new VEColor(0,169,235,.7),this.RouteMode=VERouteMode.Driving,this.RouteOptimize=VERouteOptimize.MinimizeTime,this.RouteWeight=6,this.SetBestMapView=!0,this.UseTraffic=!0}return e}(),VERouteDistanceUnit;!function(e){e[e.Mile=0]="Mile",e[e.Kilometer=1]="Kilometer"}(VERouteDistanceUnit||(VERouteDistanceUnit={}));var VERouteMode;!function(e){e[e.Driving=0]="Driving",e[e.Walking=1]="Walking"}(VERouteMode||(VERouteMode={}));var VERouteOptimize;!function(e){e[e.MinimizeTime=0]="MinimizeTime",e[e.MinimizeDistance=1]="MinimizeDistance"}(VERouteOptimize||(VERouteOptimize={}));var VERouteWarningSeverity;!function(e){e[e.None=0]="None",e[e.LowImpact=1]="LowImpact",e[e.Minor=2]="Minor",e[e.Moderate=3]="Moderate",e[e.Serious=4]="Serious"}(VERouteWarningSeverity||(VERouteWarningSeverity={}));var VERouteHintType;!function(e){e[e.PreviousIntersection=0]="PreviousIntersection",e[e.NextIntersection=1]="NextIntersection",e[e.Landmark=2]="Landmark"}(VERouteHintType||(VERouteHintType={}));var VEShapeSourceSpecification=function(){function e(e,t,o){this.MaxImportedShapes=200,this.Layer=o,this.LayerSource=t,this.Type=e}return e}(),VEDataType=function(){function e(){}return e.GeoRSS="g",e.VECollection="c",e.ImportXML="i",e.VETileSource="t",e}(),VESearchOptions=function(){function e(){this.CreateResults=!0,this.NumberOfResults=10,this.SetBestMapView=!0,this.ShowResults=!0,this.StartIndex=0,this.BoundingRectangle=null}return e}(),VEAltitudeMode;!function(e){e[e.Default=0]="Default",e[e.Absolute=1]="Absolute",e[e.RelativeToGround=2]="RelativeToGround"}(VEAltitudeMode||(VEAltitudeMode={}));var VEBirdseyeScene=function(){function e(){}return e}(),VEClusteringOptions=function(){function e(){}return e}(),VEClusteringType;!function(e){e[e.None=0]="None",e[e.Grid=1]="Grid"}(VEClusteringType||(VEClusteringType={}));var VEClusterSpecification=function(){function e(){}return e}(),VEDashboardSize=function(){function e(){}return e.Normal="normal",e.Small="small",e.Tiny="tiny",e}(),VEDistanceUnit=function(){function e(){}return e.Miles="m",e.Kilometers="k",e}(),VEFailedShapeRequest;!function(e){e[e.DoNotDraw=0]="DoNotDraw",e[e.DrawInaccurately=1]="DrawInaccurately",e[e.QueueRequest=2]="QueueRequest"}(VEFailedShapeRequest||(VEFailedShapeRequest={}));var VEImageryMetadata=function(){function e(){}return e}(),VEImageryMetadataOptions=function(){function e(){}return e}(),VEMiniMapSize;!function(e){e[e.Small=0]="Small",e[e.Large=1]="Large"}(VEMiniMapSize||(VEMiniMapSize={}));var VEModelFormat;!function(e){e[e.OBJ=0]="OBJ"}(VEModelFormat||(VEModelFormat={}));var VEModelOrientation=function(){function e(){}return e}(),VEModelScale=function(){function e(){}return e}(),VEModelScaleUnit;!function(e){e[e.Inches=0]="Inches",e[e.Feet=1]="Feet",e[e.Yards=2]="Yards",e[e.Millimeters=3]="Millimeters",e[e.Centimeters=4]="Centimeters",e[e.Meters=5]="Meters"}(VEModelScaleUnit||(VEModelScaleUnit={}));var VEModelSourceSpecification=function(){function e(){}return e}(),VEModelStatusCode;!function(e){e[e.Success=0]="Success",e[e.InvalidURL=1]="InvalidURL",e[e.Failed=2]="Failed"}(VEModelStatusCode||(VEModelStatusCode={}));var VEPrintOptions=function(){function e(){}return e}(),VERouteDeprected=function(){function e(){}return e}(),VERouteItineraryDeprecated=function(){function e(){}return e}(),VERouteType=function(){function e(){}return e.Shortest="q",e.Quickest="s",e}(),VEShapeAccuracy;!function(e){e[e.None=0]="None",e[e.Pushpin=1]="Pushpin"}(VEShapeAccuracy||(VEShapeAccuracy={}));